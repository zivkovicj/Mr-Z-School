<% provide(:title, "#{@seminar.name} Scoresheet") %>

<% provide(:headerText, "#{@seminar.name} Scoresheet") %>
<% provide(:headerPic, "scoresheet.png") %>


<%= render 'shared/navribbon' %><br/>
<%= render 'shared/teacher_name_and_edit', user: @teacher %><br/>
<%= render 'shared/class_and_edit' %>

<%= render 'shared/headline' %>

<div>
  <%= button_tag "Hide Scores", :id => "toggle_text", :first_text => "Hide Scores", :second_text => "Show Scores" %>
</div>

<br/>
<div>
  <table class="table-borderless scoreTable" id="scoreTable">
    <thead class="table-borderless">
      <th class="table-borderless">Student</th>
      <th class="rotate table-borderless consultant"><div><span>Current Stars</span></div></th>
      <th class="rotate table-borderless consultant"><div><span>Benchmark Stars</span></div></th>
      <th class="rotate table-borderless consultant"><div><span>Total Stars</span></div></th>
      <% @objectives.each_with_index do |objective, index| %>
        <th class="rotate table-borderless"><div><span>
          <%= link_to objective.short_name, edit_objective_path(objective) %>
        </span></div></th>
      <% end %>
    </thead>
    <tbody>
      <% @students.each do |student| %>
        <tr>
          <td><h4><%= link_to student.last_name_first, edit_teaching_requests_student_url(student) %> </h4></td>
          <% total_stars = student.total_stars(@seminar) %>
          <% benchmark = student.seminar_students.find_by(:seminar => @seminar).benchmark %>
          <% current_stars = total_stars - benchmark %>
          <td class="themScores to_unhide consultant"><%= current_stars %></td>
          <td class="themScores to_unhide consultant"><%= benchmark %></td>
          <td class="themScores to_unhide consultant"><%= total_stars %></td>
          <% this_ss = student.seminar_students.find_by(:seminar_id => @seminar.id) %>
          <% @objectives.each do |objective| %>
            <% thisScore = @scores.find_by(:objective => objective, :user => student) %>
            <td class="themScores to_unhide steelPanther">
              <% if thisScore %>
                <%= best_in_place thisScore, :points, :inner_class => "scoreInput" %>
              <% end %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
  
<div>
  <h3> <%= pluralize(@students.count, "Student") %> </h3>
</div>

<div>
  <%= button_to "Create a New Objective", new_objective_path, :method => :get, class: "btn btn-lg btn-primary" %><br/>
  <%= button_to "Create New Students", new_student_path, :method => :get, class: "btn btn-lg btn-primary" %><br/>
  <%#= button_to "Add an Existing Student", {:controller => "students", :action => "index"}, :method => :get, class: "btn btn-lg btn-primary" %><br/>
  <%= button_to "Set Benchmark Stars", benchmarks_seminar_path(@seminar), :method => :get, class: "btn btn-lg btn-primary" %><br/>
  
</div>

<%= button_to "Your Teacher Profile", @seminar.user,
  class: "btn btn-lg btn-primary", :method => :get %>